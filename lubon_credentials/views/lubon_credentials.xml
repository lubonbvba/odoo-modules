<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <record id="lubon_credentials_encrypt" model="ir.actions.server">

            <field name="name">Encrypt passwords</field>

            <field name="model_id" ref="model_lubon_credentials_credentials"/>
            <field name="state">code</field>
            <field name="code">self.encrypt(cr, uid, context.get('active_ids', []), context=context)</field>
            <!-- field name="code">action = self.encrypt(cr, uid, context.get('active_ids', []), context=context)</field-->
        </record>
        <record id="lubon_credentials_encrypt_item" model="ir.values">
            <field eval="'client_action_multi'" name="key2"/>
            <field eval="'lubon_credentials.credentials'" name="model"/>
            <field name="name">Encrypt passwordsTest Item</field>
            <field eval="'ir.actions.server,%d'%lubon_credentials_encrypt" name="value"/>
        </record>
        <!-- Add instructor field to existing view -->
        <record model="ir.ui.view" id="lubon_credentials_form_view">
            <field name="name">zzlubon_credentials.partner</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <notebook position="inside">
                    <page string="Credentials">
                        <field name="credential_ids"/>
                    </page>
                    <page string="Credentials 2">
                        <group string="security">
                            <field name="masterkey" widget="password"/>
                        </group>
                    </page>
                </notebook>
            </field>
        </record>

        <record model="ir.ui.view" id="lubon_credentials_users_form_view">
            <field name="name">lubon_credentials.users</field>
            <field name="model">res.users</field>
            <field name="inherit_id" ref="base.view_users_form"/>
            <field name="priority">90</field>
            <field name="arch" type="xml">
                <notebook position="inside">
                    <page string="Settings">
                        <group string="security">
                            <field name="pin" password="True">
                            </field>
                        </group>
                    </page>
                </notebook>
            </field>
        </record>

        <record model="ir.ui.view" id="lubon_credentials_tree_view">
            <field name="name">lubon_credentials.tree</field>
            <field name="model">lubon_credentials.credentials</field>
            <field name="arch" type="xml">
                <tree editable="top" class="lubon_credentials">
                    <!-- field name="credentials_type"/ -->
                    <field name="description"/>
                    <field name="user"/>
                    <field name="password01" password="True" attrs="{'readonly': [('is_saved', '=', True)]}"/>
                    <field name="password02" password="True" attrs="{'readonly': [('is_saved', '=', True)]}"/>
                    <field name="is_saved"/>
                    
                    <!-- button name="%(action_update_credentials)d" type="action" text="show" string="Set" context="{'active_id':active_id}"/ -->
                    <button name="%(action_reveal_credentials)d" type="action" string="Reveal" context="{'active_id':active_id}"/>
                    <field name="hint"/>


                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="lubon_credentials_form">
            <field name="name">lubon_credentials.form</field>
            <field name="model">lubon_credentials.credentials</field>
            <field name="arch" type="xml">
                <form string="Credentials">
                    <group>
                    <field name="description"/>
                    <field name="user"/>
                    <!-- field name="password"/ -->
                    <field name="password01" password="True" attrs="{'readonly': [('is_saved', '=', True)]}"/>
                    <field name="password02" password="True" attrs="{'readonly': [('is_saved', '=', True)]}"/>
                    <field name="is_saved"/>
                    <field name="hint"/>
                    <field name="encrypted" attrs="{'readonly': [('is_saved', '=', True)]}"/>
                </group>
                    <button name="%(action_reveal_credentials)d" type="action" text="show" string="Reveal" context="{'active_id':active_id}"/>
                    

                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="lubon_credentials_search_view">
            <field name="name">lubon_credentials.search</field>
            <field name="model">lubon_credentials.credentials</field>
            <field name="arch" type="xml">
              <search>
                <field name="description"/>
            </search>

        </field>
    </record> 
</data>
 
</openerp>
